{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.9", "generated_at": "2025-08-22T09:56:29.492919Z", "invocation_id": "daf79c66-e13b-47a3-931e-d3b88b727dac", "invocation_started_at": "2025-08-22T09:55:21.048497Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.065605Z", "completed_at": "2025-08-22T09:56:29.118393Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.124386Z", "completed_at": "2025-08-22T09:56:29.124386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07000851631164551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.yelp_transform.dim_business", "compiled": true, "compiled_code": "\n\nWITH business_reviews AS (\n    SELECT\n        business_id,\n        COUNT(*) as total_reviews,\n        AVG(stars) as avg_rating\n    FROM yelp_transform.stg_reviews\n    GROUP BY 1\n)\n\nSELECT\n    b.business_id,\n    b.name,\n    b.address,\n    b.city,\n    b.state,\n    b.postal_code,\n    b.latitude,\n    b.longitude,\n    b.original_stars,\n    b.original_review_count,\n    b.is_open,\n    b.categories,\n    COALESCE(r.total_reviews, 0) as total_reviews,\n    ROUND(COALESCE(r.avg_rating, 0), 2) as avg_rating\nFROM yelp_transform.stg_businesses b\nLEFT JOIN business_reviews r ON b.business_id = r.business_id", "relation_name": "yelp_raw_marts.dim_business", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.134971Z", "completed_at": "2025-08-22T09:56:29.147462Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.149186Z", "completed_at": "2025-08-22T09:56:29.149186Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018512248992919922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.yelp_transform.fact_review", "compiled": true, "compiled_code": "\n\nSELECT\n    review_id,\n    user_id,\n    business_id,\n    stars,\n    date,\n    text,\n    useful,\n    funny,\n    cool,\n    YEAR(date) as review_year,\n    MONTH(date) as review_month\nFROM yelp_transform.stg_reviews", "relation_name": "yelp_raw_marts.fact_review", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.168923Z", "completed_at": "2025-08-22T09:56:29.181106Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.181106Z", "completed_at": "2025-08-22T09:56:29.181106Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021674156188964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.yelp_transform.stg_businesses", "compiled": true, "compiled_code": "\n\nSELECT\n    business_id,\n    name,\n    address,\n    city,\n    state,\n    postal_code,\n    latitude,\n    longitude,\n    stars as original_stars,\n    review_count as original_review_count,\n    is_open,\n    categories\nFROM yelp_raw.businesses", "relation_name": "yelp_raw_staging.stg_businesses", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.193548Z", "completed_at": "2025-08-22T09:56:29.205514Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.206514Z", "completed_at": "2025-08-22T09:56:29.206514Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026406526565551758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.yelp_transform.stg_reviews", "compiled": true, "compiled_code": "\n\nSELECT\n    review_id,\n    user_id,\n    business_id,\n    stars,\n    date,\n    text,\n    useful,\n    funny,\n    cool\nFROM yelp_raw.reviews", "relation_name": "yelp_raw_staging.stg_reviews", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.211511Z", "completed_at": "2025-08-22T09:56:29.356129Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.358669Z", "completed_at": "2025-08-22T09:56:29.359668Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15015673637390137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.yelp_transform.top_rated_businesses", "compiled": true, "compiled_code": "\n\nWITH business_stats AS (\n    SELECT\n        b.business_id,\n        b.name,\n        b.city,\n        b.state,\n        b.avg_rating,\n        b.total_reviews,\n        COUNT(DISTINCT r.user_id) as unique_customers,\n        AVG(r.stars) as actual_avg_rating\n    FROM yelp_transform.stg_businesses b\n    JOIN yelp_transform.stg_reviews r ON b.business_id = r.business_id\n    WHERE b.total_reviews >= 10  -- Minimum review threshold\n    GROUP BY 1,2,3,4,5,6\n)\n\nSELECT\n    business_id,\n    name,\n    city,\n    state,\n    avg_rating,\n    total_reviews,\n    unique_customers,\n    actual_avg_rating,\n    CASE\n        WHEN avg_rating >= 4.5 THEN 'Elite'\n        WHEN avg_rating >= 4.0 THEN 'Excellent'\n        WHEN avg_rating >= 3.5 THEN 'Good'\n        WHEN avg_rating >= 3.0 THEN 'Average'\n        ELSE 'Below Average'\n    END as rating_category\nFROM business_stats\nORDER BY avg_rating DESC, total_reviews DESC", "relation_name": "yelp_raw_analytics.top_rated_businesses", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.371881Z", "completed_at": "2025-08-22T09:56:29.393475Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.394948Z", "completed_at": "2025-08-22T09:56:29.394948Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.030954599380493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.yelp_transform.source_not_null_yelp_transform_stg_businesses_business_id.bc99f7913f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect business_id\nfrom yelp_transform.stg_businesses\nwhere business_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.405259Z", "completed_at": "2025-08-22T09:56:29.416770Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.420784Z", "completed_at": "2025-08-22T09:56:29.420784Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01952981948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.yelp_transform.source_not_null_yelp_transform_stg_reviews_review_id.6bb08e2dcc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_id\nfrom yelp_transform.stg_reviews\nwhere review_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.426213Z", "completed_at": "2025-08-22T09:56:29.439213Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.441213Z", "completed_at": "2025-08-22T09:56:29.441213Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017468929290771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.yelp_transform.accepted_values_dim_business_avg_rating___0___5.d2fc95ba01", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        avg_rating as value_field,\n        count(*) as n_records\n\n    from yelp_raw_marts.dim_business\n    group by avg_rating\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '>= 0','<= 5'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.447742Z", "completed_at": "2025-08-22T09:56:29.457765Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.457765Z", "completed_at": "2025-08-22T09:56:29.457765Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012013435363769531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.yelp_transform.not_null_dim_business_business_id.092a5ceb52", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect business_id\nfrom yelp_raw_marts.dim_business\nwhere business_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-22T09:56:29.468211Z", "completed_at": "2025-08-22T09:56:29.471055Z"}, {"name": "execute", "started_at": "2025-08-22T09:56:29.471055Z", "completed_at": "2025-08-22T09:56:29.471055Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013289928436279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.yelp_transform.unique_dim_business_business_id.07cf75e8b8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    business_id as unique_field,\n    count(*) as n_records\n\nfrom yelp_raw_marts.dim_business\nwhere business_id is not null\ngroup by business_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 63.71141743659973, "args": {"log_level": "info", "log_format": "default", "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "show_all_deprecations": false, "require_yaml_configuration_for_mf_time_spines": false, "introspect": true, "log_file_max_bytes": 10485760, "indirect_selection": "eager", "state_modified_compare_vars": false, "vars": {}, "partial_parse_file_diff": true, "use_colors": true, "strict_mode": false, "defer": false, "require_generic_test_arguments_property": true, "exclude": [], "cache_selected_only": false, "require_resource_names_without_spaces": true, "output": "text", "version_check": true, "invocation_command": "dbt compile", "which": "compile", "skip_nodes_if_on_run_start_fails": false, "upload_to_artifacts_ingest_api": false, "show_resource_report": false, "state_modified_compare_more_unrendered_values": false, "validate_macro_args": false, "require_nested_cumulative_type_params": false, "empty": false, "select": [], "write_json": true, "project_dir": "C:\\Users\\nikki\\Documents\\yelp_ETL_data_project\\dbt\\yelp_transform", "require_all_warnings_handled_by_warn_error": false, "quiet": false, "static_parser": true, "use_fast_test_edges": false, "log_path": "C:\\Users\\nikki\\Documents\\yelp_ETL_data_project\\dbt\\yelp_transform\\logs", "print": true, "inject_ephemeral_ctes": true, "printer_width": 80, "macro_debugging": false, "populate_cache": true, "profiles_dir": "C:\\Users\\nikki\\Documents\\yelp_ETL_data_project\\dbt\\yelp_transform", "partial_parse": true, "source_freshness_run_project_hooks": true, "require_batched_execution_for_custom_microbatch_strategy": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "send_anonymous_usage_stats": true, "log_format_file": "debug", "favor_state": false, "use_colors_file": true}}